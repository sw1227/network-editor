(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[538],{9628:function(e,n,t){"use strict";t.r(n),t.d(n,{default:function(){return _e}});var a=t(9799),o=t(4942),i=t(9008),r=t(7294),d=t(6158),l=t.n(d),s=t(8797),c=t(8523),u=t(5113),p=t(6447),g=t(1519),h=t(8462),m=t(5438),f=t(7212),x=t(3946),v=t(9929),y=t(6893),j=t(7707),Z=t(1849),b=t(4519),w=t(4599);function L(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);n&&(a=a.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,a)}return t}function C(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?L(Object(t),!0).forEach((function(n){(0,o.Z)(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):L(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}var E={currentNodeIdx:0,currentEdgeIdx:0,nodes:[],edges:[]},S=function(e,n){var t,o,i,r,d,s,c;switch(n.type){case"initMap":var u=new(l().Map)(n.payload);return C(C({},e),{},{map:u});case"clickMap":if(void 0!==e.selectedNodeForEdge){var p={lngLat:n.payload,id:e.currentNodeIdx},g={source:e.selectedNodeForEdge,target:p.id,id:e.currentEdgeIdx};return C(C({},e),{},{nodes:[].concat((0,a.Z)(e.nodes),[p]),edges:[].concat((0,a.Z)(e.edges),[g]),currentNodeIdx:p.id+1,currentEdgeIdx:g.id+1,selectedNodeForEdge:p.id,editingEdge:void 0})}var h={lngLat:n.payload,id:e.currentNodeIdx};return C(C({},e),{},{nodes:[].concat((0,a.Z)(e.nodes),[h]),currentNodeIdx:h.id+1,selectedNodeForEdge:h.id});case"hover":var m,f=n.payload;if(void 0!==e.hoverNodeId)null===(m=e.map)||void 0===m||m.setFeatureState({source:"nodes",id:e.hoverNodeId},{hover:!1});return null===(t=e.map)||void 0===t||t.setFeatureState({source:"nodes",id:f},{hover:!0}),C(C({},e),{},{hoverNodeId:f});case"mouseleave":var x;if(void 0!==e.hoverNodeId)null===(x=e.map)||void 0===x||x.setFeatureState({source:"nodes",id:e.hoverNodeId},{hover:!1});return C(C({},e),{},{hoverNodeId:void 0});case"clickNode":var v=n.payload;if(void 0!==e.selectedNodeForEdge){var y=(0,a.Z)(e.edges),j={source:e.selectedNodeForEdge,target:v,id:e.currentEdgeIdx};return j.source!==j.target&&y.push(j),C(C({},e),{},{currentEdgeIdx:j.id+1,edges:y,selectedNodeForEdge:void 0,editingEdge:void 0})}return C(C({},e),{},{selectedNodeForEdge:v});case"mousemove":if(void 0!==e.selectedNodeForEdge){var Z=e.nodes.find((function(n){return n.id===e.selectedNodeForEdge})),b=Z?[Z.lngLat,n.payload]:void 0;return C(C({},e),{},{editingEdge:b})}case"escape":return void 0!==e.selectedNodeForEdge?C(C({},e),{},{selectedNodeForEdge:void 0,editingEdge:void 0}):e;case"removeNode":return C(C({},e),{},{nodes:e.nodes.filter((function(e){return e.id!==n.payload})),edges:e.edges.filter((function(e){return![e.source,e.target].includes(n.payload)}))});case"removeEdgeById":return C(C({},e),{},{edges:e.edges.filter((function(e){return e.id!==n.payload}))});case"hoverEdge":var w,L=n.payload;if(void 0!==e.hoverEdgeId)null===(w=e.map)||void 0===w||w.setFeatureState({source:"edges",id:e.hoverEdgeId},{hover:!1});return null===(o=e.map)||void 0===o||o.setFeatureState({source:"edges",id:L},{hover:!0}),C(C({},e),{},{hoverEdgeId:L});case"mouseleaveEdge":var S;if(void 0!==e.hoverEdgeId)null===(S=e.map)||void 0===S||S.setFeatureState({source:"edges",id:e.hoverEdgeId},{hover:!1});return C(C({},e),{},{hoverEdgeId:void 0});case"reset":return C(C({},E),{},{map:e.map});case"importNodeLinkJson":var I=n.payload,N=I.nodes,k=I.links,M=N.map((function(e){return{id:e.id,lngLat:new(l().LngLat)(e.lng,e.lat)}})),O=k.map((function(e,n){return{id:e.id||n,source:e.source,target:e.target}}));return C(C({},e),{},{nodes:M,edges:O,currentNodeIdx:Math.max.apply(Math,(0,a.Z)(M.map((function(e){return e.id}))))+1,currentEdgeIdx:Math.max.apply(Math,(0,a.Z)(O.map((function(e){return e.id}))))+1});case"setImage":var F=n.payload;return C(C({},e),{},{imageUrl:F.src,imageShape:{width:F.width,height:F.height},imageShapeMeter:{width:F.width,height:F.height},imageCenterLngLat:null===(i=e.map)||void 0===i?void 0:i.getCenter()});case"updateImageShapeMeter":var P=n.payload,_=P.width,R=P.height;return C(C({},e),{},{imageShapeMeter:{width:_||(null===(r=e.imageShapeMeter)||void 0===r?void 0:r.width)||0,height:R||(null===(d=e.imageShapeMeter)||void 0===d?void 0:d.height)||0}});case"updateImageRotationDeg":var D=n.payload;return C(C({},e),{},{imageRotationDeg:D});case"updateImageCenter":var z=n.payload,A=z.lng,B=z.lat;return C(C({},e),{},{imageCenterLngLat:new(l().LngLat)(A||(null===(s=e.imageCenterLngLat)||void 0===s?void 0:s.lng)||0,B||(null===(c=e.imageCenterLngLat)||void 0===c?void 0:c.lat)||0)});case"updateImageOpacity":var U=n.payload;return C(C({},e),{},{imageOpacity:U});default:return e}},I=function(e){return{type:"FeatureCollection",features:e.map((function(e){return{type:"Feature",id:e.id,geometry:{type:"Point",coordinates:[e.lngLat.lng,e.lngLat.lat]},properties:{}}}))}},N=function(e,n){return{type:"FeatureCollection",features:e.map((function(e){return k(e,n)}))}},k=function(e,n){var t=n.find((function(n){return n.id===e.source})),a=n.find((function(n){return n.id===e.target}));return{type:"Feature",id:e.id,geometry:{type:"LineString",coordinates:t&&a?[[t.lngLat.lng,t.lngLat.lat],[a.lngLat.lng,a.lngLat.lat]]:[]},properties:{}}},M=function(e){return{type:"Feature",geometry:{type:"LineString",coordinates:e?[[e[0].lng,e[0].lat],[e[1].lng,e[1].lat]]:[]},properties:{}}},O={id:"nodes",type:"circle",source:"nodes",layout:{},paint:{"circle-radius":6,"circle-color":"#f08","circle-opacity":.4,"circle-stroke-width":["case",["boolean",["feature-state","hover"],!1],2,0],"circle-stroke-color":"#f00"}},F={id:"edges",type:"line",source:"edges",layout:{},paint:{"line-color":"#f08","line-opacity":.4,"line-width":["case",["boolean",["feature-state","hover"],!1],6,3]}},P={id:"editingEdge",type:"line",source:"editingEdge",layout:{},paint:{"line-color":"#f08","line-opacity":.4,"line-width":3,"line-dasharray":[1,1]}},_=function(e,n){var t,a=(t=e,Math.PI/180*t),o=n.x,i=n.y;return{x:Math.cos(a)*o-Math.sin(a)*i,y:Math.sin(a)*o+Math.cos(a)*i}},R=t(7906),D=t(295),z=t(3252),A=t(2882),B=t(3184),U=t(3816),W=t(1733),T=t(9308),H=t(7922),J=t(8619),X=t(796),Y=t(9953),q=t(181),G=t(3508),Q=t(5893),K=function(e,n){return Math.round(e*Math.pow(10,n))/Math.pow(10,n)},V=function(e){var n=e.nodes,t=e.hoverNodeId,a=e.onEnterRow,o=e.onLeaveRow,i=e.onDeleteRow,d=(0,r.useState)(!1),l=d[0],s=d[1];return(0,Q.jsxs)(Q.Fragment,{children:[(0,Q.jsxs)(J.Z,{onClick:function(){s(!l)},children:[(0,Q.jsx)(X.Z,{children:(0,Q.jsx)(T.Z,{})}),(0,Q.jsx)(Y.Z,{primary:"Nodes"}),l?(0,Q.jsx)(q.Z,{}):(0,Q.jsx)(G.Z,{})]}),(0,Q.jsx)(H.Z,{in:l,timeout:"auto",unmountOnExit:!0,children:(0,Q.jsx)(A.Z,{component:u.Z,elevation:0,children:(0,Q.jsxs)(R.Z,{sx:{minWidth:20},size:"small","aria-label":"a dense table",children:[(0,Q.jsx)(B.Z,{children:(0,Q.jsxs)(U.Z,{children:[(0,Q.jsx)(z.Z,{align:"center",children:"id"}),(0,Q.jsx)(z.Z,{align:"center",children:"latitude"}),(0,Q.jsx)(z.Z,{align:"center",children:"longitude"}),(0,Q.jsx)(z.Z,{align:"center",children:"Delete"})]})}),(0,Q.jsx)(D.Z,{children:n.map((function(e){return(0,Q.jsxs)($,{sx:{"&:last-child td, &:last-child th":{border:0}},onMouseEnter:a(e.id),onMouseLeave:o,style:{background:t===e.id?"#def":"white"},children:[(0,Q.jsx)(z.Z,{component:"th",scope:"row",children:e.id}),(0,Q.jsx)(z.Z,{align:"left",children:K(e.lngLat.lat,6)}),(0,Q.jsx)(z.Z,{align:"left",children:K(e.lngLat.lng,6)}),(0,Q.jsx)(z.Z,{align:"center",children:(0,Q.jsx)(x.Z,{"aria-label":"delete",size:"small",onClick:i(e.id),children:(0,Q.jsx)(W.Z,{fontSize:"inherit"})})})]},e.id)}))})]})})})]})},$=(0,s.ZP)(U.Z).withConfig({displayName:"nodetable__HoverRow",componentId:"sc-14axea-0"})(["&:hover{background:#def;}"]),ee=t(8141),ne=function(e){var n=e.edges,t=e.hoverEdgeId,a=e.onEnterRow,o=e.onLeaveRow,i=e.onDeleteRow,d=(0,r.useState)(!1),l=d[0],s=d[1];return(0,Q.jsxs)(Q.Fragment,{children:[(0,Q.jsxs)(J.Z,{onClick:function(){s(!l)},children:[(0,Q.jsx)(X.Z,{children:(0,Q.jsx)(ee.Z,{})}),(0,Q.jsx)(Y.Z,{primary:"Edges"}),l?(0,Q.jsx)(q.Z,{}):(0,Q.jsx)(G.Z,{})]}),(0,Q.jsx)(H.Z,{in:l,timeout:"auto",unmountOnExit:!0,children:(0,Q.jsx)(A.Z,{component:u.Z,elevation:0,children:(0,Q.jsxs)(R.Z,{sx:{minWidth:20},size:"small","aria-label":"a dense table",children:[(0,Q.jsx)(B.Z,{children:(0,Q.jsxs)(U.Z,{children:[(0,Q.jsx)(z.Z,{align:"center",children:"id"}),(0,Q.jsx)(z.Z,{align:"center",children:"Edge info"}),(0,Q.jsx)(z.Z,{align:"center",children:"Delete"})]})}),(0,Q.jsx)(D.Z,{children:n.map((function(e){return(0,Q.jsxs)(te,{sx:{"&:last-child td, &:last-child th":{border:0}},onMouseEnter:a(e.id),onMouseLeave:o,style:{background:t===e.id?"#def":"white"},children:[(0,Q.jsx)(z.Z,{component:"th",scope:"row",children:e.id}),(0,Q.jsxs)(z.Z,{align:"left",children:["Node ",e.source," \u2192 Node ",e.target]}),(0,Q.jsx)(z.Z,{align:"center",children:(0,Q.jsx)(x.Z,{"aria-label":"delete",size:"small",onClick:i(e.id),children:(0,Q.jsx)(W.Z,{fontSize:"inherit"})})})]},e.id)}))})]})})})]})},te=(0,s.ZP)(U.Z).withConfig({displayName:"edgetable__HoverRow",componentId:"sc-1il4u5w-0"})(["&:hover{background:#def;}"]),ae=t(7357),oe=t(3321),ie=t(6798),re=t(1423),de=(0,s.ZP)(re.Z).withConfig({displayName:"common__StyledModal",componentId:"sc-ndkjj4-0"})(["position:fixed;z-index:1300;right:0;bottom:0;top:0;left:0;display:flex;align-items:center;justify-content:center;"]),le=(0,s.ZP)("div").withConfig({displayName:"common__Backdrop",componentId:"sc-ndkjj4-1"})(["z-index:-1;position:fixed;right:0;bottom:0;top:0;left:0;background-color:rgba(0,0,0,0.5);-webkit-tap-highlight-color:transparent;"]),se={width:400,bgcolor:"background.paper",p:2,px:4,pb:3},ce=(0,s.ZP)("div").withConfig({displayName:"common__NoMarginDiv",componentId:"sc-ndkjj4-2"})(["margin:0 !important;"]),ue=function(e){var n=e.open,t=e.onCloseModal,a=e.onImportNodeLinkJson,o=(0,r.useState)(!1),i=o[0],d=o[1],l=(0,r.useState)(null),s=l[0],c=l[1];return(0,Q.jsxs)(Q.Fragment,{children:[(0,Q.jsx)(ie.Z,{open:i,autoHideDuration:6e3,onClose:function(){return d(!1)},message:"Import failed",action:(0,Q.jsx)(oe.Z,{size:"small",onClick:function(){return d(!1)},children:"Close"})}),(0,Q.jsx)(de,{"aria-labelledby":"modal-title","aria-describedby":"modal-description",open:n,onClose:function(){c(null),t()},BackdropComponent:le,children:(0,Q.jsx)(ae.Z,{sx:se,children:(0,Q.jsxs)(p.Z,{spacing:2,children:[(0,Q.jsx)("h2",{id:"modal-title",children:"Import network"}),(0,Q.jsxs)(ce,{children:["Format: ",(0,Q.jsx)("a",{href:"https://networkx.org/documentation/stable/reference/readwrite/json_graph.html",children:"Node-link json"})]}),(0,Q.jsx)("input",{type:"file",id:"upload",accept:".json,.geojson",onChange:function(e){c(e.target.files)}}),(0,Q.jsx)(oe.Z,{variant:"contained",startIcon:(0,Q.jsx)(b.Z,{}),onClick:function(){if(s&&!(s.length<1)){var e=new FileReader;e.onload=function(e){var n,t=null===(n=e.target)||void 0===n?void 0:n.result;if("string"===typeof t){var o=JSON.parse(t);!function(e){var n,t,a=null===(n=e.nodes)||void 0===n?void 0:n.every((function(e){return"id"in e&&"lng"in e&&"lat"in e})),o=null===(t=e.links)||void 0===t?void 0:t.every((function(e){return"source"in e&&"target"in e}));return a&&o}(o)?d(!0):(a(o),c(null))}},e.readAsText(s[0])}},disabled:!s||s.length<1,children:"Reset map & Import"})]})})})]})},pe=t(7781),ge=t(2890),he=t(480),me=t(4054),fe=t(476),xe=function(e){var n=e.open,t=e.onCloseModal,o=e.nodes,i=e.edges,d=(0,r.useState)("node-link"),l=d[0],s=d[1];return(0,Q.jsx)(de,{"aria-labelledby":"modal-title","aria-describedby":"modal-description",open:n,onClose:t,BackdropComponent:le,children:(0,Q.jsx)(ae.Z,{sx:se,children:(0,Q.jsxs)(p.Z,{spacing:2,children:[(0,Q.jsx)("h2",{id:"modal-title",children:"Export network"}),(0,Q.jsxs)(me.Z,{component:"fieldset",children:[(0,Q.jsx)(fe.Z,{component:"legend",children:"Format"}),(0,Q.jsxs)(ge.Z,{"aria-label":"gender",name:"controlled-radio-buttons-group",value:l,onChange:function(e){s(e.target.value)},children:[(0,Q.jsx)(y.Z,{title:"https://networkx.org/documentation/stable/reference/readwrite/json_graph.html",placement:"left",children:(0,Q.jsx)(he.Z,{value:"node-link",control:(0,Q.jsx)(pe.Z,{}),label:"Node-link json"})}),(0,Q.jsx)(y.Z,{title:"FeatureCollection of nodes(Point) and edges(LineString)",placement:"left",children:(0,Q.jsx)(he.Z,{value:"geojson",control:(0,Q.jsx)(pe.Z,{}),label:"GeoJSON"})})]})]}),(0,Q.jsx)(oe.Z,{variant:"contained",startIcon:(0,Q.jsx)(v.Z,{}),onClick:function(){var e="node-link"===l?function(e,n){return{nodes:e.map((function(e){return{id:e.id,lng:e.lngLat.lng,lat:e.lngLat.lat}})),links:n.map((function(e){return{source:e.source,target:e.target}}))}}(o,i):function(e,n){return{type:"FeatureCollection",features:[].concat((0,a.Z)(e.map((function(e){return{type:"Feature",geometry:{type:"Point",coordinates:[e.lngLat.lng,e.lngLat.lat]},properties:{id:e.id}}}))),(0,a.Z)(n.map((function(n){var t=e.find((function(e){return e.id===n.source})),a=e.find((function(e){return e.id===n.target}));return{type:"Feature",geometry:{type:"LineString",coordinates:t&&a?[[t.lngLat.lng,t.lngLat.lat],[a.lngLat.lng,a.lngLat.lat]]:[]},properties:{source:n.source,target:n.target,id:n.id}}}))))}}(o,i),n=new Blob([JSON.stringify(e)],{type:"application/json"}),r=document.createElement("a");r.href=URL.createObjectURL(n),r.download="export.json",document.body.appendChild(r),r.click(),document.body.removeChild(r),t()},children:"Export"})]})})})},ve=function(e){var n=e.open,t=e.onCloseModal,a=e.onImportImage,o=(0,r.useState)(!1),i=o[0],d=o[1],l=(0,r.useState)(null),s=l[0],c=l[1],u=function(){c(null),t()};return(0,Q.jsxs)(Q.Fragment,{children:[(0,Q.jsx)(ie.Z,{open:i,autoHideDuration:6e3,onClose:function(){return d(!1)},message:"Import failed",action:(0,Q.jsx)(oe.Z,{size:"small",onClick:function(){return d(!1)},children:"Close"})}),(0,Q.jsx)(de,{"aria-labelledby":"modal-title","aria-describedby":"modal-description",open:n,onClose:u,BackdropComponent:le,children:(0,Q.jsx)(ae.Z,{sx:se,children:(0,Q.jsxs)(p.Z,{spacing:2,children:[(0,Q.jsx)("h2",{id:"modal-title",children:"Add raster image overlay"}),(0,Q.jsx)(ce,{children:"Select an image"}),(0,Q.jsx)("input",{type:"file",id:"upload",accept:"image/*",onChange:function(e){c(e.target.files)}}),(0,Q.jsx)(oe.Z,{variant:"contained",startIcon:(0,Q.jsx)(b.Z,{}),onClick:function(){if(s&&!(s.length<1)){var e=new Image;e.src=URL.createObjectURL(s[0]),e.onload=function(){a(e)},u()}},disabled:!s||s.length<1,children:"Add image"})]})})})]})},ye=function(e){var n=e.open,t=e.onCloseModal,a=e.onReset;return(0,Q.jsx)(de,{"aria-labelledby":"modal-title","aria-describedby":"modal-description",open:n,onClose:t,BackdropComponent:le,children:(0,Q.jsx)(ae.Z,{sx:se,children:(0,Q.jsxs)(p.Z,{spacing:2,children:[(0,Q.jsx)("h2",{id:"modal-title",children:"Reset"}),(0,Q.jsx)(ce,{children:"All the nodes and edges will be deleted."}),(0,Q.jsx)(oe.Z,{variant:"contained",color:"warning",onClick:function(){a(),t()},children:"Reset"})]})})})},je=t(4161),Ze={Default_ja:"mapbox://styles/sw1227/ckqyzf3tm1s0v17rv3rnaxgxm",Light_en:"mapbox://styles/mapbox/light-v10",Dark_en:"mapbox://styles/mapbox/dark-v10",Outdoors_en:"mapbox://styles/mapbox/outdoors-v11",Satellite:"mapbox://styles/mapbox/satellite-v9"},be=function(e){var n=e.mapStyle,t=e.onSelect,a=(0,r.useState)(!1),o=a[0],i=a[1],d=function(e){return function(){t(e),i(!1)}};return(0,Q.jsxs)(Q.Fragment,{children:[(0,Q.jsxs)(J.Z,{onClick:function(){i(!o)},children:[(0,Q.jsx)(X.Z,{children:(0,Q.jsx)(je.Z,{})}),(0,Q.jsx)(Y.Z,{primary:"Base map: ".concat(n)}),o?(0,Q.jsx)(q.Z,{}):(0,Q.jsx)(G.Z,{})]}),(0,Q.jsx)(H.Z,{in:o,timeout:"auto",unmountOnExit:!0,children:(0,Q.jsx)(h.Z,{component:"div",disablePadding:!0,children:Object.keys(Ze).map((function(e){return(0,Q.jsx)(J.Z,{sx:{pl:4},onClick:d(e),children:(0,Q.jsx)(Y.Z,{primary:e})},e)}))})})]})},we=t(6693),Le=t(8075),Ce=t(7109),Ee=t(7178),Se=function(e){var n=e.initWidth,t=e.initHeight,a=e.initCenter,o=e.opacity,i=e.onChangeWidth,d=e.onChangeHeight,l=e.onChangeRotation,s=e.onChangeLng,c=e.onChangeLat,u=e.onChangeOpacity,p=(0,r.useState)(!1),g=p[0],h=p[1],f=(0,r.useState)(String(n)),x=f[0],v=f[1],y=(0,r.useState)(String(t)),j=y[0],Z=y[1],b=(0,r.useState)("0"),w=b[0],L=b[1],C=(0,r.useState)(String(a.lng)),E=C[0],S=C[1],I=(0,r.useState)(String(a.lat)),N=I[0],k=I[1];return(0,r.useEffect)((function(){var e=parseFloat(x);isNaN(e)||i(e)}),[x]),(0,r.useEffect)((function(){var e=parseFloat(j);isNaN(e)||d(e)}),[j]),(0,r.useEffect)((function(){var e=parseFloat(w);isNaN(e)||l(e)}),[w]),(0,r.useEffect)((function(){var e=parseFloat(E);isNaN(e)||s(e)}),[E]),(0,r.useEffect)((function(){var e=parseFloat(N);isNaN(e)||c(e)}),[N]),(0,Q.jsxs)(Q.Fragment,{children:[(0,Q.jsxs)(J.Z,{onClick:function(){h(!g)},children:[(0,Q.jsx)(X.Z,{children:(0,Q.jsx)(we.Z,{})}),(0,Q.jsx)(Y.Z,{primary:"Image Overlay"}),g?(0,Q.jsx)(q.Z,{}):(0,Q.jsx)(G.Z,{})]}),(0,Q.jsxs)(H.Z,{in:g,timeout:"auto",unmountOnExit:!0,children:[(0,Q.jsxs)(Ie,{subheader:(0,Q.jsx)(m.Z,{children:"Actual size of image [meter]"}),children:[(0,Q.jsx)(Le.Z,{id:"width-input",label:"Width",variant:"standard",InputProps:{endAdornment:(0,Q.jsx)(Ce.Z,{position:"end",children:"[m]"})},error:isNaN(parseFloat(x)),value:x,onChange:function(e){return v(e.target.value)}}),(0,Q.jsx)("br",{}),(0,Q.jsx)(Le.Z,{id:"height-input",label:"Height",variant:"standard",InputProps:{endAdornment:(0,Q.jsx)(Ce.Z,{position:"end",children:"[m]"})},error:isNaN(parseFloat(j)),value:j,onChange:function(e){return Z(e.target.value)}})]}),(0,Q.jsx)(Ie,{subheader:(0,Q.jsx)(m.Z,{children:"Rotation"}),children:(0,Q.jsx)(Le.Z,{id:"rotation-input",label:"Rotation",variant:"standard",InputProps:{endAdornment:(0,Q.jsx)(Ce.Z,{position:"end",children:"[deg]"})},error:isNaN(parseFloat(w)),value:w,onChange:function(e){return L(e.target.value)}})}),(0,Q.jsxs)(Ie,{subheader:(0,Q.jsx)(m.Z,{children:"Location"}),children:[(0,Q.jsx)(Le.Z,{id:"lng-input",label:"Longitude",variant:"standard",InputProps:{endAdornment:(0,Q.jsx)(Ce.Z,{position:"end",children:"[deg]"})},error:isNaN(parseFloat(E)),value:E,onChange:function(e){return S(e.target.value)}}),(0,Q.jsx)("br",{}),(0,Q.jsx)(Le.Z,{id:"lng-input",label:"Latitude",variant:"standard",InputProps:{endAdornment:(0,Q.jsx)(Ce.Z,{position:"end",children:"[deg]"})},error:isNaN(parseFloat(N)),value:N,onChange:function(e){return k(e.target.value)}})]}),(0,Q.jsx)(Ie,{subheader:(0,Q.jsx)(m.Z,{children:"Opacity"}),children:(0,Q.jsx)(Ne,{value:o,onChange:function(e,n){return u(n)},min:0,max:1,step:.1,size:"small","aria-label":"Opacity",valueLabelDisplay:"auto"})})]})]})},Ie=(0,s.ZP)(h.Z).withConfig({displayName:"overlay__InputList",componentId:"sc-1kads67-0"})(["padding:24px;"]),Ne=(0,s.ZP)(Ee.ZP).withConfig({displayName:"overlay__OpacitySlider",componentId:"sc-1kads67-1"})(["margin-top:28px;"]),ke=t(1990),Me=t.n(ke);function Oe(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);n&&(a=a.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,a)}return t}function Fe(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?Oe(Object(t),!0).forEach((function(n){(0,o.Z)(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):Oe(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}var Pe={accessToken:"pk.eyJ1Ijoic3cxMjI3IiwiYSI6ImNrbngyazRhcjBtY3Iyd3RnODhjbDhscWsifQ.6Uc-Lboqa0WhZbnnFJWFSA",container:"mapbox",localIdeographFontFamily:"sans-serif",center:new(l().LngLat)(139.744,35.72),zoom:16},_e=function(){var e,n,t=(0,r.useReducer)(S,E),o=t[0],d=t[1],l=(0,r.useState)(!1),s=l[0],u=l[1],L=(0,r.useState)(!1),C=L[0],k=L[1],R=(0,r.useState)(!1),D=R[0],z=R[1],A=(0,r.useState)(!1),B=A[0],U=A[1],W=(0,r.useState)("Default_ja"),T=W[0],H=W[1];(0,r.useEffect)((function(){d({type:"initMap",payload:Fe(Fe({},Pe),{},{style:Ze[T]})})}),[T]),(0,r.useEffect)((function(){if(o.map){var e=o.map;e.on("style.load",(function(){e.addSource("nodes",{type:"geojson",data:I(o.nodes)}),e.addSource("edges",{type:"geojson",data:N(o.edges,o.nodes)}),e.addSource("editingEdge",{type:"geojson",data:M()}),e.addLayer(O),e.addLayer(F),e.addLayer(P),J(),e.on("click","nodes",(function(e){var n,t=null===(n=e.features)||void 0===n?void 0:n[0].id;void 0!==t&&d({type:"clickNode",payload:t}),e.originalEvent.preventDefault()})),e.on("click",(function(e){e.originalEvent.defaultPrevented||d({type:"clickMap",payload:e.lngLat})})),e.on("mousemove","nodes",(function(e){var n,t=null===(n=e.features)||void 0===n?void 0:n[0].id;void 0!==t&&d({type:"hover",payload:t})})),e.on("mouseleave","nodes",(function(){d({type:"mouseleave"})})),e.on("mousemove","edges",(function(e){var n,t=null===(n=e.features)||void 0===n?void 0:n[0].id;void 0!==t&&d({type:"hoverEdge",payload:t})})),e.on("mouseleave","edges",(function(){d({type:"mouseleaveEdge"})})),e.on("mousemove",(function(e){d({type:"mousemove",payload:e.lngLat})})),e.getCanvas().addEventListener("keydown",(function(e){e.preventDefault(),"Escape"===e.key&&d({type:"escape"})}))}))}}),[o.map]),(0,r.useEffect)((function(){var e,n=null===(e=o.map)||void 0===e?void 0:e.getSource("nodes");n&&n.setData(I(o.nodes))}),[o.nodes]),(0,r.useEffect)((function(){var e,n=null===(e=o.map)||void 0===e?void 0:e.getSource("edges");n&&n.setData(N(o.edges,o.nodes))}),[o.edges]),(0,r.useEffect)((function(){var e,n=null===(e=o.map)||void 0===e?void 0:e.getSource("editingEdge");o.map&&n&&(o.editingEdge?(n.setData(M(o.editingEdge)),o.map.setLayoutProperty("editingEdge","visibility","visible")):o.map.setLayoutProperty("editingEdge","visibility","none"))}),[o.editingEdge]),(0,r.useEffect)((function(){J()}),[o.imageUrl,o.imageShapeMeter,o.imageRotationDeg,o.imageCenterLngLat,o.imageOpacity]);var J=function(){var e,n,t,i,r,d,l;if(null!==(e=o.map)&&void 0!==e&&e.getLayer("raster-image")&&o.map.removeLayer("raster-image"),null!==(n=o.map)&&void 0!==n&&n.getSource("raster-image")&&o.map.removeSource("raster-image"),o.map&&o.imageUrl&&o.imageShape&&o.imageShapeMeter&&o.imageCenterLngLat){var s=new c.ui(c.TS.IX),u=s.lngLatToXY(o.imageCenterLngLat),p=u.x,g=u.y,h=o.imageRotationDeg||0,m=_(-h,{x:+o.imageShapeMeter.height/2,y:-o.imageShapeMeter.width/2}),f=_(-h,{x:+o.imageShapeMeter.height/2,y:+o.imageShapeMeter.width/2}),x=_(-h,{x:-o.imageShapeMeter.height/2,y:+o.imageShapeMeter.width/2}),v=_(-h,{x:-o.imageShapeMeter.height/2,y:-o.imageShapeMeter.width/2}),y={nw:s.XYToLngLat({x:p+m.x,y:g+m.y}),ne:s.XYToLngLat({x:p+f.x,y:g+f.y}),se:s.XYToLngLat({x:p+x.x,y:g+x.y}),sw:s.XYToLngLat({x:p+v.x,y:g+v.y})};o.map.addSource("raster-image",{type:"image",url:o.imageUrl,coordinates:[[y.nw.lng,y.nw.lat],[y.ne.lng,y.ne.lat],[y.se.lng,y.se.lat],[y.sw.lng,y.sw.lat]]}),null===(t=o.map)||void 0===t||t.addLayer({id:"raster-image",type:"raster",source:"raster-image",paint:{"raster-fade-duration":0,"raster-opacity":null==o.imageOpacity?.5:o.imageOpacity}}),null===(i=o.map)||void 0===i||i.moveLayer(O.id),null===(r=o.map)||void 0===r||r.moveLayer(F.id),null===(d=o.map)||void 0===d||d.moveLayer(P.id);var j=Math.min.apply(Math,(0,a.Z)(Object.values(y).map((function(e){return e.lng})))),Z=Math.max.apply(Math,(0,a.Z)(Object.values(y).map((function(e){return e.lng})))),b=Math.min.apply(Math,(0,a.Z)(Object.values(y).map((function(e){return e.lat})))),w=Math.max.apply(Math,(0,a.Z)(Object.values(y).map((function(e){return e.lat}))));null===(l=o.map)||void 0===l||l.fitBounds([[j,b],[Z,w]])}};return(0,Q.jsxs)(Q.Fragment,{children:[(0,Q.jsxs)(i.default,{children:[(0,Q.jsx)("title",{children:"Network editor"}),(0,Q.jsx)("link",{href:"https://api.mapbox.com/mapbox-gl-js/v2.0.1/mapbox-gl.css",rel:"stylesheet"})]}),(0,Q.jsx)("div",{id:"mapbox",className:Me().mapbox}),(0,Q.jsx)(ue,{open:s,onCloseModal:function(){return u(!1)},onImportNodeLinkJson:function(e){d({type:"reset"}),d({type:"importNodeLinkJson",payload:e}),u(!1)}}),(0,Q.jsx)(xe,{open:C,onCloseModal:function(){return k(!1)},nodes:o.nodes,edges:o.edges}),(0,Q.jsx)(ve,{open:D,onCloseModal:function(){return z(!1)},onImportImage:function(e){d({type:"setImage",payload:e})}}),(0,Q.jsx)(ye,{open:B,onCloseModal:function(){return U(!1)},onReset:function(){d({type:"reset"})}}),(0,Q.jsxs)(Re,{children:[(0,Q.jsx)(f.ZP,{secondaryAction:(0,Q.jsxs)(p.Z,{direction:"row",spacing:1,children:[(0,Q.jsx)(y.Z,{title:"Import",children:(0,Q.jsx)(x.Z,{edge:"end",onClick:function(){return u(!0)},children:(0,Q.jsx)(b.Z,{})})}),(0,Q.jsx)(y.Z,{title:"Export",children:(0,Q.jsx)(x.Z,{edge:"end",onClick:function(){return k(!0)},children:(0,Q.jsx)(v.Z,{})})}),(0,Q.jsx)(y.Z,{title:"Add raster image overlay",children:(0,Q.jsx)(x.Z,{edge:"end",onClick:function(){return z(!0)},children:(0,Q.jsx)(w.Z,{})})}),(0,Q.jsx)(y.Z,{title:"Fit to nodes",children:(0,Q.jsx)("span",{children:(0,Q.jsx)(x.Z,{edge:"end",onClick:function(){var e;if(!(o.nodes.length<3)){var n=Math.min.apply(Math,(0,a.Z)(o.nodes.map((function(e){return e.lngLat.lng})))),t=Math.max.apply(Math,(0,a.Z)(o.nodes.map((function(e){return e.lngLat.lng})))),i=Math.min.apply(Math,(0,a.Z)(o.nodes.map((function(e){return e.lngLat.lat})))),r=Math.max.apply(Math,(0,a.Z)(o.nodes.map((function(e){return e.lngLat.lat}))));null===(e=o.map)||void 0===e||e.fitBounds([[n,i],[t,r]])}},disabled:o.nodes.length<3,children:(0,Q.jsx)(j.Z,{})})})}),(0,Q.jsx)(y.Z,{title:"Reset",children:(0,Q.jsx)("span",{children:(0,Q.jsx)(x.Z,{edge:"end",onClick:function(){return U(!0)},disabled:o.nodes.length<1&&!o.imageUrl,children:(0,Q.jsx)(Z.Z,{})})})})]}),children:(0,Q.jsx)("h4",{children:"Network Editor"})}),(0,Q.jsxs)(h.Z,{sx:{width:"100%",maxWidth:360,bgcolor:"background.paper"},subheader:(0,Q.jsx)(m.Z,{children:"Settings"}),children:[(0,Q.jsx)(g.Z,{}),(0,Q.jsx)(V,{nodes:o.nodes,hoverNodeId:o.hoverNodeId,onEnterRow:function(e){return function(){return d({type:"hover",payload:e})}},onLeaveRow:function(){return d({type:"mouseleave"})},onDeleteRow:function(e){return function(){d({type:"removeNode",payload:e})}}}),(0,Q.jsx)(g.Z,{}),(0,Q.jsx)(ne,{edges:o.edges,hoverEdgeId:o.hoverEdgeId,onEnterRow:function(e){return function(){d({type:"hoverEdge",payload:e})}},onLeaveRow:function(){d({type:"mouseleaveEdge"})},onDeleteRow:function(e){return function(){d({type:"removeEdgeById",payload:e})}}}),(0,Q.jsx)(g.Z,{}),(0,Q.jsx)(be,{mapStyle:T,onSelect:function(e){return H(e)}}),(0,Q.jsx)(g.Z,{}),o.imageUrl?(0,Q.jsxs)(Q.Fragment,{children:[(0,Q.jsx)(Se,{initWidth:(null===(e=o.imageShape)||void 0===e?void 0:e.width)||0,initHeight:(null===(n=o.imageShape)||void 0===n?void 0:n.height)||0,initCenter:o.imageCenterLngLat||Pe.center,opacity:null==o.imageOpacity?.5:o.imageOpacity,onChangeWidth:function(e){d({type:"updateImageShapeMeter",payload:{width:e}})},onChangeHeight:function(e){d({type:"updateImageShapeMeter",payload:{height:e}})},onChangeRotation:function(e){d({type:"updateImageRotationDeg",payload:e})},onChangeLng:function(e){d({type:"updateImageCenter",payload:{lng:e}})},onChangeLat:function(e){d({type:"updateImageCenter",payload:{lat:e}})},onChangeOpacity:function(e){d({type:"updateImageOpacity",payload:e})}}),(0,Q.jsx)(g.Z,{})]}):null]})]})]})},Re=(0,s.ZP)(u.Z).withConfig({displayName:"map__SidePaper",componentId:"sc-urva01-0"})(["position:absolute;left:0px;top:0px;width:350px;height:100vh;padding:0px;overflow:scroll;"])},134:function(e,n,t){(window.__NEXT_P=window.__NEXT_P||[]).push(["/map",function(){return t(9628)}])},1990:function(e){e.exports={mapbox:"Map_mapbox__GQDDM"}}},function(e){e.O(0,[634,507,774,888,179],(function(){return n=134,e(e.s=n);var n}));var n=e.O();_N_E=n}]);